<html>
<head>
<title>For Specific Users Only</title>
<script type="text/javascript" src="./js/jquery-1.7.1.min.js"></script>
<script type="text/javascript" src="./js/cookies.js"></script>
<script type="text/javascript">
$(window).load(function () {
	var userId = readCookie("userIdCookie");
	if (userId == null || userId == "") {
		createNewUser();
	} else {
		readUserById(userId);
	}
});
function readUserById(userId) {
	$.ajax({ 
		url: "/users/" + userId,
		type: "GET",
  		dataType: "json"
  	}).done(function(data) {
  		setUpForUser(data.name, data.id);
  	});
}
function createNewUser() {
	var ts = new Date().getTime();
	$.ajax({ 
		url: "/users",
		type: "POST",
		data: {user : {name: "Anonymous-" + ts}},
  		dataType: "json"
  	}).done(function(data) {
  		createCookie("userIdCookie", data.id, 365);
  		setUpForUser(data.name, data.id);
	}).fail(function() { 
		alert("error"); 
	});
}
function setUpForUser(userName, userId) {
	$("#userHeader").html("User #" + userId + " : " + userName);
	$("#editLink").attr("href", "/users/" + userId + "/edit");
}
function clearUser() {
	createCookie("userIdCookie", "", 0);
  	return false;
}
</script>
<style type="text/css">
	body>div {
		width: 100%;
	}
</style>
</head>
<body>
	<div id="startingDisplay">Checking for user info....</div>
	<div id="userHeader">&nbsp;</div>
	<div id="impressionsButtons">Buttons</div>
	<div id="admininstrativeLinks">
		<a id="editLink" href="/users/?">Edit my info</a>
		|
		<a href="javascript:clearUser();">Clear Cookies</a>
	</div>
</body>
</html>